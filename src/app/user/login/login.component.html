<div class="login-page" fxLayout="row" fxLayout.xs="column" fxLayoutAlign="center" fxLayoutGap="50px">
  <div class="logo-container" fxFlexAlign="center">
    <app-tccg-logo></app-tccg-logo>
    <span>防疫追蹤溯源實名登記</span>
  </div>
  <mat-card fxFlexAlign="center">
    <mat-card-content>
      <mat-tab-group #tabGroup dynamicHeight mat-align-tabs="center"
                     (selectedIndexChange)="selectedIndexChangeHandler($event)">
        <mat-tab label="洽公訪客">
          <form class="login-form" [formGroup]="registerGuestUserFormGroup">
            <mat-form-field class="login-field">
              <input #name matInput placeholder="訪客姓名" formControlName="name"/>
            </mat-form-field>
            <mat-form-field class="login-field">
              <mat-label>行動電話</mat-label>
              <span matPrefix>+886 &nbsp;</span>
              <input #phone matInput type="tel" maxlength="10" placeholder="0911111111" formControlName="phone"/>
            </mat-form-field>
            <mat-form-field *ngIf="verify" class="login-field" appearance="outline">
              <mat-label>簡訊驗證碼</mat-label>
              <input matInput type="tel" maxlength="4" formControlName="otp_code"/>
            </mat-form-field>
          </form>
        </mat-tab>
        <mat-tab label="公務帳號" [disabled]="verify">
          <form class="login-form" [formGroup]="loginTccgUserFormGroup">
            <mat-form-field class="login-field">
              <input #account matInput placeholder="公務帳號" formControlName="account"/>
              <span matSuffix>@taichung.gov.tw</span>
            </mat-form-field>
            <mat-form-field class="login-field">
              <input #password matInput placeholder="密碼" formControlName="password"
                     [type]="hide ? 'password' : 'text'"/>
              <mat-icon matSuffix (click)="hide = !hide">
                {{ hide ? 'visibility_off' : 'visibility' }}
              </mat-icon>
              <mat-hint>提示：同開機密碼</mat-hint>
            </mat-form-field>
          </form>
        </mat-tab>
      </mat-tab-group>
    </mat-card-content>
    <mat-card-actions>
      <button *ngIf="verify" mat-raised-button color="primary" class="login-field"
              [disabled]="(otp_ttl == 0) || registerGuestUserFormGroup.invalid" 
              (click)="verifyGuestUserPhoneOTP()">
        送出，剩餘 {{ otp_ttl }} 秒
      </button>
      <button *ngIf="!tabGroupIndex && !verify" mat-raised-button color="primary" class="login-field"
              [disabled]="registerGuestUserFormGroup.invalid"
              (click)="registerGuestUser(name.value, phone.value)">
        驗證行動電話
      </button>
      <button *ngIf="tabGroupIndex" mat-raised-button color="primary" class="login-field" 
              [disabled]="loginTccgUserFormGroup.invalid" 
              (click)="loginTccgUser(account.value, password.value)">
        登入公務帳號
      </button>
    </mat-card-actions>
  </mat-card>
</div>